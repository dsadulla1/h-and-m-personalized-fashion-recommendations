nohup: ignoring input
/home/deepaksadulla/notebooks/kaggle-notebooks/h-and-m-personalized-fashion-recommendations/notebooks/preprocess-data.py:217: FutureWarning: Treating datetime data as categorical rather than numeric in `.describe` is deprecated and will be removed in a future version of pandas. Specify `datetime_is_numeric=True` to silence this warning and adopt the future behavior now.
  data['transactions_train']['t_dat'].describe()
Reading articles.csv
Reading customers.csv
Reading transactions_train.csv
******** articles ********
   article_id  product_code  prod_name  product_type_no product_type_name  \
0   108775015        108775  Strap top              253          Vest top   
1   108775044        108775  Strap top              253          Vest top   

   product_group_name  graphical_appearance_no graphical_appearance_name  \
0  Garment Upper body                  1010016                     Solid   
1  Garment Upper body                  1010016                     Solid   

   colour_group_code colour_group_name  perceived_colour_value_id  \
0                  9             Black                          4   
1                 10             White                          3   

  perceived_colour_value_name  perceived_colour_master_id  \
0                        Dark                           5   
1                       Light                           9   

  perceived_colour_master_name  department_no department_name index_code  \
0                        Black           1676    Jersey Basic          A   
1                        White           1676    Jersey Basic          A   

   index_name  index_group_no index_group_name  section_no  \
0  Ladieswear               1       Ladieswear          16   
1  Ladieswear               1       Ladieswear          16   

             section_name  garment_group_no garment_group_name  \
0  Womens Everyday Basics              1002       Jersey Basic   
1  Womens Everyday Basics              1002       Jersey Basic   

                               detail_desc  
0  Jersey top with narrow shoulder straps.  
1  Jersey top with narrow shoulder straps.  
******** customers ********
                                         customer_id  FN  Active  \
0  00000dbacae5abe5e23885899a1fa44253a17956c6d1c3... NaN     NaN   
1  0000423b00ade91418cceaf3b26c6af3dd342b51fd051e... NaN     NaN   

  club_member_status fashion_news_frequency   age  \
0             ACTIVE                   NONE 49.00   
1             ACTIVE                   NONE 25.00   

                                         postal_code  
0  52043ee2162cf5aa7ee79974281641c6f11a68d276429a...  
1  2973abc54daa8a5f8ccfe9362140c63247c5eee03f1d93...  
******** transactions_train ********
        t_dat                                        customer_id  article_id  \
0  2018-09-20  000058a12d5b43e67d225668fa1f8d618c13dc232df0ca...   663713001   
1  2018-09-20  000058a12d5b43e67d225668fa1f8d618c13dc232df0ca...   541518023   

   price  sales_channel_id  
0   0.05                 2  
1   0.03                 2  
******** articles ********
(105542, 25) ['article_id', 'product_code', 'prod_name', 'product_type_no', 'product_type_name', 'product_group_name', 'graphical_appearance_no', 'graphical_appearance_name', 'colour_group_code', 'colour_group_name', 'perceived_colour_value_id', 'perceived_colour_value_name', 'perceived_colour_master_id', 'perceived_colour_master_name', 'department_no', 'department_name', 'index_code', 'index_name', 'index_group_no', 'index_group_name', 'section_no', 'section_name', 'garment_group_no', 'garment_group_name', 'detail_desc']
******** customers ********
(1371980, 7) ['customer_id', 'FN', 'Active', 'club_member_status', 'fashion_news_frequency', 'age', 'postal_code']
******** transactions_train ********
(31788324, 5) ['t_dat', 'customer_id', 'article_id', 'price', 'sales_channel_id']
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 1371980 entries, 0 to 1371979
Data columns (total 7 columns):
 #   Column                  Non-Null Count    Dtype  
---  ------                  --------------    -----  
 0   customer_id             1371980 non-null  object 
 1   FN                      476930 non-null   float64
 2   Active                  464404 non-null   float64
 3   club_member_status      1365918 non-null  object 
 4   fashion_news_frequency  1355971 non-null  object 
 5   age                     1356119 non-null  float64
 6   postal_code             1371980 non-null  object 
dtypes: float64(3), object(4)
memory usage: 73.3+ MB
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 31788324 entries, 0 to 31788323
Data columns (total 5 columns):
 #   Column            Dtype  
---  ------            -----  
 0   t_dat             object 
 1   customer_id       object 
 2   article_id        int64  
 3   price             float64
 4   sales_channel_id  int64  
dtypes: float64(1), int64(2), object(2)
memory usage: 1.2+ GB
26
starting 0 out of 26
starting 1 out of 26
starting 2 out of 26
starting 3 out of 26
starting 4 out of 26
starting 5 out of 26
starting 6 out of 26
starting 7 out of 26
starting 8 out of 26
starting 9 out of 26
starting 10 out of 26
starting 11 out of 26
starting 12 out of 26
starting 13 out of 26
starting 14 out of 26
starting 15 out of 26
starting 16 out of 26
starting 17 out of 26
starting 18 out of 26
starting 19 out of 26
starting 20 out of 26
starting 21 out of 26
starting 22 out of 26
starting 23 out of 26
starting 24 out of 26
starting 25 out of 26
Traceback (most recent call last):
  File "/home/deepaksadulla/notebooks/kaggle-notebooks/h-and-m-personalized-fashion-recommendations/notebooks/preprocess-data.py", line 427, in <module>
    valid_df = slice_and_agg(dates_set_array[tv_i], dates_set_array[test_i])
  File "/home/deepaksadulla/notebooks/kaggle-notebooks/h-and-m-personalized-fashion-recommendations/notebooks/preprocess-data.py", line 374, in slice_and_agg
    data_slice = data_slice.sample(NUM_SAMPLES).copy()
  File "/anaconda/envs/Dev/lib/python3.9/site-packages/pandas/core/generic.py", line 5446, in sample
    sampled_indices = sample.sample(obj_len, size, replace, weights, rs)
  File "/anaconda/envs/Dev/lib/python3.9/site-packages/pandas/core/sample.py", line 150, in sample
    return random_state.choice(obj_len, size=size, replace=replace, p=weights).astype(
  File "mtrand.pyx", line 909, in numpy.random.mtrand.RandomState.choice
ValueError: a must be greater than 0 unless no samples are taken
